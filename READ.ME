Для создания динамической библиотеки на языке программирования С++ в среде разработки Visual Studio нужно создать проект с использованием шаблона ""Динамическая библиотека DLL. 
Если это необходимо, можно настроить свойста проекта. Обратить внимание нужно на конфигурацию, платформу и настройку препроцессора.
После создания проекта необходимо создать заголовочный файл, в котором объявить нужные методы и классы. Также в этом файле нужно объявить обертку для динамической библиотеки. В заголовочном файле должен быть следующий код:
#ifdef SIMULATOR_EXPORTS  -  проверка на то, определен ли макрос
#define SIMULATOR_API __declspec(dllexport) - если макрос определен, то функции будут экспортироваться из DLL
#else
#define SIMULATOR_API __declspec(dllimport) - - если макрос не определен, то функции будут импортироваться из DLL
#endif
Также в проект нужно добавить 
